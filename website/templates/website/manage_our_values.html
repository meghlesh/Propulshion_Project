{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Our Values | Propulsion Technology</title>
    <link rel="icon" type="image/png" href="{% static 'img/logo6.png'%}">
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-[#EAF4E0] font-sans text-[#053830]">

<!-- Blur Loader -->
<div id="blur-loader"
     class="fixed inset-0 flex items-center justify-center bg-white/60 backdrop-blur-md z-[9999] hidden">
  <div class="w-16 h-16 border-4 border-[#053830] border-t-transparent rounded-full animate-spin"></div>
</div>

<!-- Navbar -->
<nav class="bg-[#053830] text-white p-5 flex justify-between items-center shadow-lg">
    <h1 class="text-2xl font-bold">Manage Our Values</h1>
    <div>
        <a href="{% url 'home' %}" class="text-[#FF9728] font-semibold hover:text-white mr-6 transition-colors">Back To Home</a>
        <a href="{% url 'admin_dashboard' %}" class="text-[#FF9728] font-semibold hover:text-white mr-6">Dashboard</a>
        <a href="{% url 'admin_logout' %}" class="bg-[#FF9728] text-[#053830] px-4 py-2 rounded-xl font-semibold hover:bg-white hover:text-[#053830] transition-all">Logout</a>
    </div>
</nav>

<!-- Success Messages -->
{% if messages %}
<div id="flash-messages">
    {% for message in messages %}
        <div class="mb-3 px-4 py-3 rounded-lg font-medium transition-all duration-500
            {% if message.tags == 'success' %} bg-green-100 text-green-800 border border-green-300
            {% elif message.tags == 'error' %} bg-red-100 text-red-800 border border-red-300
            {% elif message.tags == 'warning' %} bg-yellow-100 text-yellow-800 border border-yellow-300
            {% else %} bg-blue-100 text-blue-800 border border-blue-300
            {% endif %}
        ">
            {{ message }}
        </div>
    {% endfor %}
</div>
{% endif %}


<!-- Existing Values Section -->
<main class="max-w-6xl mx-auto mt-8 px-4 pb-10">
    <h2 class="text-2xl font-extrabold mb-6 text-[#053830]">Existing Values</h2>
    
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-10">
        {% for value in values %}
        <div class="bg-white rounded-3xl shadow-2xl p-6 border-l-4 {% if value.is_active %}border-[#053830]{% else %}border-gray-400{% endif %} hover:shadow-[#053830]/30 transition-all">
            <div class="flex justify-between items-start mb-3">
                <div>
                    {% if value.icon %}
                    <span class="text-3xl mr-2">{{ value.icon }}</span>
                    {% endif %}
                  <h3 class="text-xl font-bold text-[#053830] inline break-all whitespace-normal">
    {{ value.title }}
</h3>
                </div>
                {% if value.is_active %}
                    <span class="px-3 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-700">Active</span>
                {% else %}
                    <span class="px-3 py-1 text-xs font-semibold rounded-full bg-gray-200 text-gray-600">Inactive</span>
                {% endif %}
            </div>
            
            <!-- FIX: Add break-words -->
            <p class="text-gray-600 text-sm mb-4 leading-relaxed break-words">
                {{ value.description|truncatewords:25 }}
            </p>
            
            <div class="flex justify-end space-x-2">
                <a href="{% url 'toggle_value_status' value.pk %}" 
                   class="px-3 py-2 {% if value.is_active %}bg-yellow-500 hover:bg-yellow-600{% else %}bg-green-500 hover:bg-green-600{% endif %} text-white text-xs font-semibold rounded-xl transition-all shadow-md transform hover:scale-105">
                    {% if value.is_active %} Deactivate{% else %} Activate{% endif %}
                </a>
                <a href="{% url 'edit_our_value' value.pk %}" 
                   class="px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white text-xs font-semibold rounded-xl transition-all shadow-md transform hover:scale-105">
                     Edit
                </a>
                <a href="{% url 'delete_our_value' value.pk %}" 
                   class="px-3 py-2 bg-red-500 hover:bg-red-600 text-white text-xs font-semibold rounded-xl transition-all shadow-md transform hover:scale-105">
                     Delete
                </a>
            </div>
        </div>
        {% empty %}
        <div class="col-span-3 text-center py-12 text-gray-500 bg-white rounded-3xl shadow-lg">
            <p class="text-lg font-semibold">No values added yet.</p>
            <p class="text-sm">Add your first company value below!</p>
        </div>
        {% endfor %}
    </div>

    <!-- Add New Value Form -->
    <div class="bg-white rounded-3xl shadow-2xl p-8 mt-10">
        <h2 class="text-3xl font-extrabold mb-6 text-center text-[#053830]">Add New Value</h2>
        
        <form method="POST" class="space-y-6">
            {% csrf_token %}
            
            <!-- Title -->
            <div>
                <label for="title" class="block font-semibold mb-2 text-[#053830]">
                    Title <span class="text-red-600">*</span> (Max 50 Characters)
                </label>
                <input type="text" id="title" name="title" required maxlength="50" 
                       placeholder="e.g., Collaboration"
                       class="w-full border border-gray-300 rounded-xl px-4 py-3 focus:ring-2 focus:ring-[#053830] focus:border-[#053830] transition-all">

                <p id="title-counter" class="text-xs text-gray-500 mt-1">0 / 50 characters</p>
            </div>

            <!-- Description -->
            <div>
                <label for="description" class="block font-semibold mb-2 text-[#053830]">Description <span class="text-red-600">*</span> (Max 300 Characters)</label>
                <textarea id="description"
                          name="description"
                          required
                          rows="4"
                          maxlength="300"
                          placeholder="Describe this value in detail... (Max 300 characters)"
                          class="w-full border border-gray-300 rounded-xl px-4 py-3 break-words focus:ring-2 focus:ring-[#053830] focus:border-[#053830] transition-all"></textarea>

                <p id="desc-counter" class="text-xs text-gray-500 mt-1">0 / 300 characters</p>
            </div>

            <!-- Active Status Checkbox -->
            <div class="flex items-center bg-gray-50 p-4 rounded-xl border border-gray-200">
                <input type="checkbox" id="is_active" name="is_active" checked 
                       class="w-5 h-5 text-[#053830] border-gray-300 rounded focus:ring-[#053830]">
                <label for="is_active" class="ml-3 text-sm font-semibold text-[#053830]">
                    âœ… Active (Display this value on the website)
                </label>
            </div>

            <!-- Submit Button -->
            <div class="flex justify-center mt-8">
                <button type="submit" 
                        class="bg-[#053830] text-white px-10 py-4 rounded-xl font-semibold text-lg hover:bg-[#FF9728] hover:text-[#053830] transition-all shadow-lg shadow-[#053830]/40 transform hover:scale-105 hover:-translate-y-1">
                     Add Value
                </button>
            </div>
        </form>
    </div>
</main>

<!-- Live Character Counter Script -->
<script>
    const descField = document.getElementById("description");
    const counter = document.getElementById("desc-counter");
    const titleField = document.getElementById("title");
    const titleCounter = document.getElementById("title-counter");

    if (descField && counter) {
        descField.addEventListener("input", () => {
            counter.textContent = `${descField.value.length} / 300 characters`;
        });
    }

    if (titleField && titleCounter) {
        titleField.addEventListener("input", () => {
            titleCounter.textContent = `${titleField.value.length} / 50 characters`;
        });
    }
</script>

<!-- Auto-hide success message -->
<script>
    setTimeout(() => {
        const messages = document.querySelectorAll('[class*="bg-green-100"]');
        messages.forEach(msg => {
            msg.style.transition = 'opacity 0.5s';
            msg.style.opacity = '0';
            setTimeout(() => msg.remove(), 500);
        });
    }, 5000);
</script>

<script>
  document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("blur-loader").classList.remove("hidden");
  });

  window.addEventListener("load", () => {
      document.getElementById("blur-loader").classList.add("hidden");
  });

  const addValueForm = document.querySelector("form[method='POST']");
  if (addValueForm) {
      addValueForm.addEventListener("submit", () => {
          document.getElementById("blur-loader").classList.remove("hidden");
      });
  }

  const editLinks = document.querySelectorAll("a[href*='edit_our_value']");
  editLinks.forEach(link => {
      link.addEventListener("click", () => {
          document.getElementById("blur-loader").classList.remove("hidden");
      });
  });

  const deleteLinks = document.querySelectorAll("a[href*='delete_our_value']");
  deleteLinks.forEach(link => {
      link.addEventListener("click", () => {
          document.getElementById("blur-loader").classList.remove("hidden");
      });
  });

  const toggleLinks = document.querySelectorAll("a[href*='toggle_value_status']");
  toggleLinks.forEach(link => {
      link.addEventListener("click", () => {
          document.getElementById("blur-loader").classList.remove("hidden");
      });
  });
</script>
<script>
document.addEventListener("DOMContentLoaded", () => {
    const flashBox = document.getElementById("flash-messages");
    if (flashBox) {
        setTimeout(() => {
            flashBox.style.transition = "opacity 0.6s ease";
            flashBox.style.opacity = "0";

            setTimeout(() => flashBox.remove(), 600);
        }, 3000);  // 3 Seconds
    }
});
</script>


</body>
</html>